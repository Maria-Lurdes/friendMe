{"ast":null,"code":"import { deleteObject, getStorage, ref } from \"firebase/storage\";\nimport { CreateEditPostModalComponent } from \"../create-edit-post-modal/create-edit-post-modal.component\";\nimport { MatDialogConfig } from \"@angular/material/dialog\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"../../shared/services/post.service\";\nimport * as i3 from \"../../shared/services/auth.service\";\nimport * as i4 from \"../../shared/services/alert.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"@angular/material/card\";\nimport * as i8 from \"@angular/material/icon\";\n\nfunction PetCardComponent_mat_icon_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-icon\", 8);\n    i0.ɵɵlistener(\"click\", function PetCardComponent_mat_icon_4_Template_mat_icon_click_0_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.openEditFormModal());\n    });\n    i0.ɵɵtext(1, \"edit\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PetCardComponent_img_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 9);\n  }\n}\n\nfunction PetCardComponent_img_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 10);\n  }\n}\n\nfunction PetCardComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"mat-icon\", 8);\n    i0.ɵɵlistener(\"click\", function PetCardComponent_div_13_Template_mat_icon_click_1_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.removePost());\n    });\n    i0.ɵɵtext(2, \"delete\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nconst _c0 = function (a2) {\n  return [\"/pets-dashboard\", \"pet-info\", a2];\n};\n\nexport let PetCardComponent = /*#__PURE__*/(() => {\n  class PetCardComponent {\n    constructor(dialog, postService, authService, alert) {\n      this.dialog = dialog;\n      this.postService = postService;\n      this.authService = authService;\n      this.alert = alert;\n      this.favouritesList = [];\n      this.isAdmin = false;\n      this.isFavourite = false;\n    }\n\n    ngOnInit() {\n      this.isAdmin = localStorage.getItem(\"role\") === \"admin\";\n      this.getChosenPosts();\n    }\n\n    getChosenPosts() {\n      this.isFavourite = !!(this.favouritesList.length && this.favouritesList.find(id => id === this.petPost.id));\n    }\n\n    removePost() {\n      this.postService.remove(this.petPost.id).subscribe(() => {\n        let fireStorage = getStorage();\n        const imageRef = ref(fireStorage, `pets-avatars/${this.petPost.id}`);\n        deleteObject(imageRef).then(() => {\n          this.alert.success(\"Post was successfully deleted\");\n          this.postService.getAll();\n        }).catch(() => {\n          this.alert.danger(\"Smth went wrong, try again later\");\n        });\n      });\n    }\n\n    openEditFormModal() {\n      let config = new MatDialogConfig();\n      let dialogRef = this.dialog.open(CreateEditPostModalComponent, config);\n      dialogRef.componentInstance.postToEdit = this.petPost;\n    }\n\n    addRemoveToFavoirites() {\n      if (this.isFavourite) {\n        this.isFavourite = false;\n        let updatedArray = this.favouritesList.filter(id => id !== this.petPost.id);\n        this.updateLocalStorage(updatedArray);\n      } else {\n        this.isFavourite = true;\n        let updatedArray = [...this.favouritesList];\n        updatedArray.push(this.petPost.id);\n        this.updateLocalStorage(updatedArray);\n      }\n    }\n\n    updateLocalStorage(list) {\n      localStorage.removeItem(this.userId);\n      localStorage.setItem(this.userId, JSON.stringify(list));\n      this.authService.getFavourites();\n    }\n\n  }\n\n  PetCardComponent.ɵfac = function PetCardComponent_Factory(t) {\n    return new (t || PetCardComponent)(i0.ɵɵdirectiveInject(i1.MatDialog), i0.ɵɵdirectiveInject(i2.PostService), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.AlertService));\n  };\n\n  PetCardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PetCardComponent,\n    selectors: [[\"app-pet-card\"]],\n    inputs: {\n      petPost: \"petPost\",\n      userId: \"userId\",\n      favouritesList: \"favouritesList\"\n    },\n    decls: 14,\n    vars: 11,\n    consts: [[1, \"card\", 3, \"ngClass\"], [3, \"click\", 4, \"ngIf\"], [1, \"icons-block\"], [1, \"goTo\", \"heart\", 3, \"click\"], [\"alt\", \"\", \"src\", \"../../../assets/icons/heart-outlined.png\", 4, \"ngIf\"], [\"alt\", \"\", \"src\", \"../../../assets/icons/heart-filled.png\", 4, \"ngIf\"], [1, \"goTo\", 3, \"routerLink\"], [\"class\", \"delete-block\", 4, \"ngIf\"], [3, \"click\"], [\"alt\", \"\", \"src\", \"../../../assets/icons/heart-outlined.png\"], [\"alt\", \"\", \"src\", \"../../../assets/icons/heart-filled.png\"], [1, \"delete-block\"]],\n    template: function PetCardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"mat-card\", 0)(1, \"mat-card-title\")(2, \"span\");\n        i0.ɵɵtext(3);\n        i0.ɵɵtemplate(4, PetCardComponent_mat_icon_4_Template, 2, 0, \"mat-icon\", 1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 2)(6, \"div\", 3);\n        i0.ɵɵlistener(\"click\", function PetCardComponent_Template_div_click_6_listener() {\n          return ctx.addRemoveToFavoirites();\n        });\n        i0.ɵɵtemplate(7, PetCardComponent_img_7_Template, 1, 0, \"img\", 4);\n        i0.ɵɵtemplate(8, PetCardComponent_img_8_Template, 1, 0, \"img\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"div\", 6)(10, \"mat-icon\");\n        i0.ɵɵtext(11, \"keyboard_arrow_right\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(12, \"mat-card-actions\");\n        i0.ɵɵtemplate(13, PetCardComponent_div_13_Template, 3, 0, \"div\", 7);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵstyleProp(\"background-image\", \"url(\" + ctx.petPost.avatar + \")\");\n        i0.ɵɵproperty(\"ngClass\", ctx.petPost.color);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", ctx.petPost.name, \" \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isAdmin);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isFavourite);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isFavourite);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(9, _c0, ctx.petPost.id));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.isAdmin);\n      }\n    },\n    dependencies: [i5.NgClass, i5.NgIf, i6.RouterLink, i7.MatCard, i7.MatCardTitle, i7.MatCardActions, i8.MatIcon],\n    styles: [\".card[_ngcontent-%COMP%]{border-radius:25px;width:305px;height:360px;background-size:80%!important;background-repeat:no-repeat!important;background-position:center!important;display:flex;flex-direction:column;justify-content:space-between;margin-bottom:30px;margin-right:20px}.card[_ngcontent-%COMP%]   .icons-block[_ngcontent-%COMP%]{display:flex}.card[_ngcontent-%COMP%]   .icons-block[_ngcontent-%COMP%]   .heart[_ngcontent-%COMP%]{margin-right:5px}.card.green[_ngcontent-%COMP%]{background:#e2f5cb}.card.orange[_ngcontent-%COMP%]{background:#ffe9c2}.card.blue[_ngcontent-%COMP%]{background:#c2ebff}.card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center}.card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:5px;cursor:pointer}.card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]   .goTo[_ngcontent-%COMP%]{cursor:pointer;width:40px;height:40px;background:white;border-radius:16px;display:flex;align-items:center;justify-content:center}.card[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]   .goTo[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:35px;width:35px;height:35px}.card[_ngcontent-%COMP%]   .mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.card[_ngcontent-%COMP%]   .mat-card-actions[_ngcontent-%COMP%]   .delete-block[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:white;display:flex;align-items:center;justify-content:center;margin-right:7px;cursor:pointer}.card[_ngcontent-%COMP%]   .mat-card-actions[_ngcontent-%COMP%]   .delete-block[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:25px;width:25px;height:25px;color:#fc5252}@media (max-width: 768px){.card[_ngcontent-%COMP%]{margin-right:0}}\"]\n  });\n  return PetCardComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}